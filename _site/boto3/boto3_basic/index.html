<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Boto3를 이용한 Amazon S3, Kinesis Data Firehose 사용하기 - kelpin’s blog</title>
<meta name="description" content="AWS를 Python 개발환경에서 사용하기 위한 방법중 하나는 Boto3 라이브러리를 이용하는 것이다. 이 테스트는 Boto3를 이용하여 아래의 서비스에 접근하여 사용하는 방법을 공유하기 위한 목적이 있다.">


  <meta name="author" content="kelpin">


<meta property="og:type" content="article">
<meta property="og:locale" content="ko">
<meta property="og:site_name" content="kelpin's blog">
<meta property="og:title" content="Boto3를 이용한 Amazon S3, Kinesis Data Firehose 사용하기">
<meta property="og:url" content="http://localhost:4000/boto3/boto3_basic/">


  <meta property="og:description" content="AWS를 Python 개발환경에서 사용하기 위한 방법중 하나는 Boto3 라이브러리를 이용하는 것이다. 이 테스트는 Boto3를 이용하여 아래의 서비스에 접근하여 사용하는 방법을 공유하기 위한 목적이 있다.">







  <meta property="article:published_time" content="2019-12-16T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/boto3/boto3_basic/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "kelpin",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="kelpin's blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          kelpin's blog
          <span class="site-subtitle">To the best</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avata.png" alt="kelpin" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">kelpin</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>There are no masterpieces made by lazy artists.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul, South of korea</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/jangseongwoo" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      
        <li>
          <a href="mailto:seongwoo.dev@gmail.com">
            <meta itemprop="email" content="seongwoo.dev@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> 이메일
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Boto3를 이용한 Amazon S3, Kinesis Data Firehose 사용하기">
    <meta itemprop="description" content="AWS를 Python 개발환경에서 사용하기 위한 방법중 하나는 Boto3 라이브러리를 이용하는 것이다. 이 테스트는 Boto3를 이용하여 아래의 서비스에 접근하여 사용하는 방법을 공유하기 위한 목적이 있다.">
    <meta itemprop="datePublished" content="December 16, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Boto3를 이용한 Amazon S3, Kinesis Data Firehose 사용하기
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  12 분 소요

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="테스트-목적">테스트 목적</h1>

<p>AWS를 Python 개발환경에서 사용하기 위한 방법중 하나는 Boto3 라이브러리를 이용하는 것이다.</p>

<p>이 테스트는 Boto3를 이용하여 아래의 서비스에 접근하여 사용하는 방법을 공유하기 위한 목적이 있다.</p>

<ul>
  <li>
    <p>Amazon S3</p>
  </li>
  <li>
    <p>Kinesis Firehose</p>
  </li>
</ul>

<h1 id="테스트-환경">테스트 환경</h1>

<p>테스트 환경은 다음과 같다.</p>

<p>OS : macOS mojave 10.14.6</p>

<p>Python 버전 : 3.7.3</p>

<p>Boto3 버전 : 1.9.215</p>

<p>AWS CLI 버전 정보</p>

<ul>
  <li>
    <p>aws-cli : 1.16.222 </p>
  </li>
  <li>
    <p>Python : 2.7.16 </p>
  </li>
  <li>
    <p>Darwin : 18.7.0 </p>
  </li>
  <li>
    <p>botocore : 1.12.212</p>
  </li>
</ul>

<p>Tree 버전 : 1.8.0</p>

<p>테스트 사전 정보</p>

<p>다음과 같은 사전 정보가 필요하다.</p>

<ul>
  <li>
    <p>테스트 환경 구성 방법</p>
  </li>
  <li>
    <p>awscli 설치 및 사용법</p>
  </li>
</ul>

<h2 id="테스트-환경-구성-방법">테스트 환경 구성 방법</h2>

<p>virtual env로 환경을 구성한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ virtualenv .venv
Using base prefix '/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7'
New python executable in /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/python3.7
Also creating executable in /Users/kevin/dev/boto3_test/amazon_s3/.venv/bin/python
Installing setuptools, pip, wheel... 
</code></pre></div></div>

<p>virtual env 활성화후 boto3 설치</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source .venv/bin/activate
$ pip3 install boto3
</code></pre></div></div>

<h2 id="aws-cli-사용법">AWS CLI 사용법</h2>

<p>다음 링크를 참고한다.</p>

<ul>
  <li>
    <p><a href="https://docs.aws.amazon.com/ko_kr/cli/latest/userguide/install-macos.html">macOS에 AWS CLI 설치</a></p>
  </li>
  <li>
    <p><a href="https://docs.aws.amazon.com/ko_kr/cli/latest/userguide/cli-services-s3.html">AWS CLI에서 Amazon S3 사용</a></p>
  </li>
</ul>

<hr />

<h1 id="테스트--amazon-s3">테스트 : Amazon S3</h1>

<h2 id="테스트-목적-1">테스트 목적</h2>

<p>S3 사용에 있어 다음과 같은 케이스가 발생할 것으로 예상된다.</p>

<ul>
  <li>
    <p>로컬 파일을 S3에 업로드 하기</p>
  </li>
  <li>
    <p>S3에서 로컬로 파일 다운로드하기</p>
  </li>
  <li>
    <p>S3에서 파일 삭제하기 </p>
  </li>
  <li>
    <p>S3의 디렉터리를 로컬로 다운로드하기</p>
  </li>
  <li>
    <p>로컬 디렉터리를 S3에 업로드 하기</p>
  </li>
</ul>

<p>이 테스트는 위의 케이스 별로 시나리오대로 진행하고 나온 결과가 올바른 지를 확인하는 데에 목적이 있다.</p>

<h2 id="케이스별-공통사항">케이스별 공통사항</h2>

<p>세부 케이스를 진행하는데 이 테스트에서는 다음과 같은 공통사항이 있다.</p>

<ul>
  <li>
    <p>미리 지정한 profile로 session 인스턴스 생성</p>
  </li>
  <li>
    <p>session 인스턴스로 s3 resource 인스턴스 생성</p>
  </li>
</ul>

<p>Python 코드로 정리하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3

def get_s3():
    # aws profile
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3 
</code></pre></div></div>

<h2 id="케이스--로컬-파일을-s3에-업로드-하기">케이스 : 로컬 파일을 S3에 업로드 하기</h2>

<p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>

<ol>
  <li>
    <p>로컬 파일을 생성한다.</p>
  </li>
  <li>
    <p>생성된 로컬 파일을 s3://bucket/boto3-test/ 경로에 업로드 한다.</p>
  </li>
</ol>

<p>다음과 같이 Python 코드를 작성하고 실행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3

def get_s3():
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3


def make_file(path="./boto3_file_upload_test.txt"):
    with open(path, "w") as wf:
        wf.write("This file boto3 file upload test !!!!")


def main():
    # make file
    file_path = "./boto3_file_upload_test.txt"
    make_file(file_path)

    # upload s3
    s3 = get_s3()
    bucket = s3.Bucket('bucket')
    bucket.upload_file(
        file_path, 'boto3-test/boto3_file_upload_test.txt')


if __name__ == "__main__":
    main()
</code></pre></div></div>

<p>생성한 로컬 파일이 s3에 업로드 되었는지 확인한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://bucket/boto3-test/
2019-08-23 14:39:54          0
2019-08-23 14:45:08         37 boto3_file_upload_test.txt
</code></pre></div></div>

<p>테스트 결과는 다음과 정리할 수 있다.</p>

<ul>
  <li>
    <p>파일을 생성하여 Boto3를 이용하여 S3에 업로드한다.</p>
  </li>
  <li>
    <p>AWS CLI를 통해 생성된 파일이 업로드가 된 것을 확인할 수 있다.</p>
  </li>
</ul>

<h2 id="케이스--s3에서-로컬로-파일-다운로드하기">케이스 : S3에서 로컬로 파일 다운로드하기</h2>

<p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>

<p>s3://bucket/boto3-test/boto3_file_upload.txt 파일을 로컬로 다운로드 한다.</p>

<p>다음과 같이 Python코드를 작성하고 실행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3

def get_s3():
    # aws profile
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3

def main():
    download_file_path = "./boto3_file_upload_test2.txt"

    # download s3
    s3 = get_s3()
    bucket = s3.Bucket('bucket')
    bucket.download_file(
        'boto3-test/boto3_file_upload_test.txt', download_file_path)

if __name__ == "__main__":
    main()
</code></pre></div></div>

<p>다운로드한 파일을 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat boto3_file_upload_test2.txt
This file boto3 file upload test !!!!%
</code></pre></div></div>

<p>테스트 결과는 다음과 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 S3의 업로드된 파일을 다운로드한다.</p>
  </li>
  <li>
    <p>커널 명령을 통해 실제로 S3에서 파일이 다운로드 된 것을 확인할 수 있다.</p>
  </li>
</ul>

<h2 id="케이스--s3의-파일-삭제하기">케이스 : S3의 파일 삭제하기 </h2>

<p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>

<p>s3://bucket/boto3-test/boto3_file_upload.txt 파일을 삭제한다.</p>

<p>다음과 같이 Python코드를 작성하고 실행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3

def get_s3():
    # aws profile
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3

def main():
    # delete s3
    s3 = get_s3()
    bucket = s3.Bucket('bucket')
    obj = bucket.Object('boto3-test/boto3_file_upload_test.txt')
    obj.delete()

if __name__ == "__main__":
    main()
</code></pre></div></div>

<p>삭제 되었는지 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://bucket/boto3-test/
2019-08-23 14:39:54          0
</code></pre></div></div>

<p>테스트 결과는 다음과 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 S3의 업로드된 파일을 삭제한다.</p>
  </li>
  <li>
    <p>AWS CLI를 통해 실제로 S3에서 파일이 삭제 된 것을 확인할 수 있었다</p>
  </li>
</ul>

<h2 id="케이스--s3-디렉터리-다운로드-하기">케이스 : S3 디렉터리 다운로드 하기</h2>

<p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>위의 S3 경로 s3://bucket/boto3-test/download_test_directory 디렉터리(빈 디렉터리는 제외)를 로컬로 다운로드한다.
</code></pre></div></div>

<p>다운로드 할 파일을 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://bucket/boto3-test/download_test_directory --recursive
2019-08-26 19:07:16         39 boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file1.txt
2019-08-26 19:07:17         39 boto3-test/download_test_directory/dir1/dir1_1/dir1_1_file2.txt
2019-08-26 19:07:15         39 boto3-test/download_test_directory/dir1/dir1_file1.txt
2019-08-26 19:07:14         39 boto3-test/download_test_directory/dir2/dir2_file1.txt
2019-08-26 19:07:14         39 boto3-test/download_test_directory/dir2/dir2_file2.txt
2019-08-26 19:08:10          0 boto3-test/download_test_directory/dir3/
2019-08-26 19:07:13         39 boto3-test/download_test_directory/file1.txt
2019-08-26 19:07:13         39 boto3-test/download_test_directory/file2.txt 
</code></pre></div></div>

<p>다음과 같은 Python 코드를 작성하고 실행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3
import os


def get_s3():
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3


def download_directory_to_s3(s3_dir_path, local_dir_path):
    s3 = get_s3()
    bucket = s3.Bucket('bucket')

    path_list = list()
    for obj in bucket.objects.filter(Prefix=s3_dir_path):
        s3_path = obj.key
        local_path = s3_path.replace(s3_dir_path, local_dir_path)

        if s3_path[-1] == '/':
            continue

        dir_name = os.path.dirname(local_path)
        if not os.path.exists(dir_name):
            print("make directory {}".format(dir_name))
            os.makedirs(dir_name)

        path_list.append([s3_path, local_path])

    for path in path_list:
        print("Download from {} to {}".format(path[0], path[1]))
        bucket.download_file(path[0], path[1])


def main():
    parameter = {"s3_dir_path": "boto3-test/download_test_directory/",
                 "local_dir_path": "./download_test_directory/",
                 }
    download_directory_to_s3(**parameter)


if __name__ == "__main__":
    main()

</code></pre></div></div>

<p>디렉터리가 정상적으로 다운로드 되었는지 확인한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree download_test_directory
download_test_directory
├── dir1
│   ├── dir1_1
│   │   ├── dir1_1_file1.txt
│   │   └── dir1_1_file2.txt
│   └── dir1_file1.txt
├── dir2
│   ├── dir2_file1.txt
│   └── dir2_file2.txt
├── file1.txt
└── file2.txt
3 directories, 7 files
</code></pre></div></div>

<p>테스트 결과는 다음과 같이 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 S3의 업로드된 디렉터리를 로컬로 다운로드한다. (빈 디렉터리는 제외)</p>
  </li>
  <li>
    <p>커널 명령을 통해 실제로 S3에서 로컬로 디렉터리가 다운로드 된 것을 확인할 수 있다.</p>
  </li>
</ul>

<h2 id="케이스--로컬-디렉터리를-s3에-업로드-하기">케이스 : 로컬 디렉터리를 S3에 업로드 하기</h2>

<p>다음과 같은 시나리오를 바탕으로 테스트를 진행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>로컬 디렉터리(빈 디렉터리는 제외)를 s3 경로 s3://bucket/boto3-test/upload_test_directory에 업로드 한다.
</code></pre></div></div>

<p>업로드할 디렉터리는 다음과 같은 구조로 이루어져 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree upload_test_directory
upload_test_directory
├── dir1
│   ├── dir1_1
│   │   ├── dir1_1_file1.txt
│   │   └── dir1_1_file2.txt
│   └── dir1_file1.txt
├── dir2
│   ├── dir2_file1.txt
│   └── dir2_file2.txt
├── dir3
├── file1.txt
└── file2.txt
</code></pre></div></div>

<p>다음과 같은 Python 코드를 작성하고 실행한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3
import os


def get_s3():
    session = boto3.Session(profile_name="test")
    s3 = session.resource('s3')
    return s3


def upload_directory_to_s3(local_dir_path, s3_dir_path):
    path_list = list()
    for path, sub_dirs, files in os.walk(local_dir_path):
        for filename in files:
            local_file_path = os.path.join(path, filename)

            s3_file_path_depart = [s3_dir_path,
                                   os.path.relpath(local_file_path, local_dir_path)]
            s3_file_path = "".join(s3_file_path_depart)
            path_list.append([local_file_path, s3_file_path])

    s3 = get_s3()
    bucket = s3.Bucket('bucket')

    for paths in path_list:
        print("upload from {} to {}".format(paths[0], paths[1]))
        bucket.upload_file(paths[0], paths[1])


def main():
    parameter = {"local_dir_path": "./upload_test_directory/",
                 "s3_dir_path": "boto3-test/upload_test_directory/"}
    upload_directory_to_s3(**parameter)


if __name__ == "__main__":
    main()

</code></pre></div></div>

<p>os 모듈중 정리가 필요한 메서드를 아래에 정리하였다.</p>

<p>os.walk(디렉터리 경로)</p>

<ul>
  <li>
    <p>해당 디렉터리 경로를 중심으로 하위 디렉터리를 탐색하여 generator 타입로 반환해준다.</p>
  </li>
  <li>
    <p>반환되는 정보는 path, sub_dirs, files 형태이며 이에 대한 설명은 다음과 같다</p>

    <ul>
      <li>
        <p>path : 경로</p>
      </li>
      <li>
        <p>sub_dirs : path 하위 디렉터리들의 이름들</p>
      </li>
      <li>
        <p>files : path 하위 파일의 이름들</p>
      </li>
    </ul>
  </li>
</ul>

<p>디렉터리의 업로드가 잘 되었는지 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://bucket/boto3-test/upload_test_directory/ --recursive
2019-08-26 16:42:02       6148 boto3-test/upload_test_directory/.DS_Store
2019-08-26 16:42:04       6148 boto3-test/upload_test_directory/dir1/.DS_Store
2019-08-26 16:42:05       6148 boto3-test/upload_test_directory/dir1/dir1_1/.DS_Store
2019-08-26 16:42:07         37 boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file1.txt
2019-08-26 16:42:08         37 boto3-test/upload_test_directory/dir1/dir1_1/dir1_1_file2.txt
2019-08-26 16:42:04         37 boto3-test/upload_test_directory/dir1/dir1_file1.txt
2019-08-26 16:42:03         37 boto3-test/upload_test_directory/dir2/dir2_file1.txt
2019-08-26 16:42:03         37 boto3-test/upload_test_directory/dir2/dir2_file2.txt
2019-08-26 16:42:02         37 boto3-test/upload_test_directory/file1.txt
2019-08-26 16:42:01         37 boto3-test/upload_test_directory/file2.txt 
</code></pre></div></div>

<p>테스트 결과는 다음과 같이 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 로컬 디렉터리(빈 디렉터리는 제외)를 S3에 업로드한다.</p>
  </li>
  <li>
    <p>AWS CLI 명령을 통해 실제로 로컬에서 S3에 업로드 된 것을 확인할 수 있었다.</p>
  </li>
</ul>

<hr />

<h1 id="테스트--kinesis-data-firehose">테스트 : Kinesis Data Firehose</h1>

<h2 id="테스트-목적-2">테스트 목적 </h2>

<p>Kinesis Data Firehose 사용에 있어 다음과 같은 케이스가 발생할 것으로 예상된다. </p>

<ul>
  <li>
    <p>Delivery stream 리스트 확인하기</p>
  </li>
  <li>
    <p>단일 레코드를 Firehose에 보내기</p>
  </li>
  <li>
    <p>복수 레코드를 Firehose에 보내기</p>
  </li>
</ul>

<p>이 테스트는 위의 케이스 별로 시나리오대로 진행하고 나온 결과가 올바른 지를 확인하는 데에 목적이 있다.</p>

<h2 id="테스트전-확인사항">테스트전 확인사항</h2>

<p>테스트전 Firehose 정상 동작 확인</p>

<p>Firehose가 정상적으로 동작하는지에 대한 확인은 Management console상에서 해당 Delivery Stream의 “Test with demo data”를 통하여 알 수 있다.</p>

<h2 id="케이스--delivery-stream-리스트-확인하기">케이스 : Delivery stream 리스트 확인하기</h2>

<p>다음과 같은 시나리오를 바탕으로 진행한다.</p>

<p>Firehose 클라이언트에 접근하여 접근가능한 Delivery stream의 목록을 출력한다.</p>

<p>다음과 같은 파이썬 코드를 작성한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3

def get_firehose_client():
    session = boto3.Session(profile_name="test")
    firehose = session.client("firehose")
    return firehose


def list_delivery_streams():
    firehose = get_firehose_client()

    response_direct_put = firehose.list_delivery_streams(
        DeliveryStreamType="DirectPut")
    response_kinesis_stream = firehose.list_delivery_streams(
        DeliveryStreamType="KinesisStreamAsSource")
    print("List of Deliver Streams")
    print("Direct Put : {}".format(response_direct_put["DeliveryStreamNames"]))
    print("Kinesis Stream As Source : {}".format(
        response_kinesis_stream["DeliveryStreamNames"]))


def main():
    list_delivery_streams()


if __name__ == "__main__":
    main()
</code></pre></div></div>

<p>파이썬 코드를 실행하면 다음과 같은 결과를 확인할 수 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3 main.py
List of Deliver Streams
DirectPut : ['test-firehose-es-poc']
KinesisStream As Source : ['test-stream-firehose-es-poc']
</code></pre></div></div>

<p>AWS CLI로 Delivery stream 리스트를 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws firehose list-delivery-streams
{
 "DeliveryStreamNames": [
 "test-firehose-es-poc",
 "test-stream-firehose-es-poc"
 ],
 "HasMoreDeliveryStreams": false
}
</code></pre></div></div>

<p>테스트 결과는 다음과 같이 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 Delivery Stream의 목록을 확인할 수 있다.</p>
  </li>
  <li>
    <p>AWS CLI 명령을 통해 실제로 확인한 결과와 Boto3로 확인한 결과가 동일함을 알 수 있다.</p>
  </li>
</ul>

<h2 id="케이스--단일-레코드를-firehose에-보내기">케이스 : 단일 레코드를 Firehose에 보내기</h2>

<p>다음과 같은 시나리오를 바탕으로 진행한다.</p>

<p>다음과 같은 샘플 데이터를 ”test-firehose-es-poc” Delivery stream으로 전송한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	"user_id": "Aster-Kotlin-Sapphire-564",
	"app_version": "v1.5.16(90)",
	"device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
	"device_manufacturer": "LG",
	"device_name": "LG G7 ThinQ",
	"device_model": "LM-G710N",
	"device_os": "Android",
	"device_os_number": "8.0",
	"event": "interest_service_click",
	"interest_id": 1201,
	"index": 1,
	"interest_name": "창업/스타트업",
	"interest_service_id": None,
	"interest_service_type": "2",
	"interest_service_name": "piano",
	"timestamp": "2019-04-30T07:30:00Z"
}
</code></pre></div></div>

<p>“test-firehose-es-poc” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.</p>

<p>다음과 같은 Python 코드를 작성한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3
import json


def get_firehose_client():
    session = boto3.Session(profile_name="test")
    firehose = session.client("firehose")
    return firehose


def put_record_to_delivery_stream(test_data):
    print("Put record to Delivery Stream")

    firehose = get_firehose_client()

    response = firehose.put_record(
        DeliveryStreamName="test-firehose-es-poc",
        Record={"Data": json.dumps(test_data, ensure_ascii=False)}
    )

    print(response)


def main():
    test_data = {
        "user_id": "Aster-Kotlin-Sapphire-564",
        "app_version": "v1.5.16(90)",
        "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
        "device_manufacturer": "LG",
        "device_name": "LG G7 ThinQ",
        "device_model": "LM-G710N",
        "device_os": "Android",
        "device_os_number": "8.0",
        "event": "interest_service_click",
        "interest_id": 1201,
        "index": 1,
        "interest_name": "창업/스타트업",
        "interest_service_id": None,
        "interest_service_type": "2",
        "interest_service_name": "piano",
        "timestamp": "2019-04-30T07:30:00Z"
    }

    put_record_to_delivery_stream(test_data)


if __name__ == "__main__":
    main()
</code></pre></div></div>

<p>Python 코드를 실행하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3 main.py
Put record to Delivery Stream
{'RecordId': 'OkvHgs4vIsuRjYw0O5VZB1EobIDBMq7nrvxe/eXDMtdQEDC+eFnEL3T5cILNN+pGD4cu284LsuuC0dAWO7GCZcU3tVcxnr8gFfYfFMsNLuz6KLrbOAV1NaN6oPcxhicH5CpdBHAsxFoZPugkAGe7axq9odkI+CMIsD76w7pHUF2I7rQUb8hswnKp1iHx6O6Ip4MbvwefA2U1kPyyqnP1hTPprg/M8xY4', 'Encrypted': False, 'ResponseMetadata': {'RequestId': 'f609df57-39b8-ccff-a3d4-eadd7b964c48', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': 'f609df57-39b8-ccff-a3d4-eadd7b964c48', 'x-amz-id-2': 'Rwyt+v8XyhuqHJYMgpacWRLeSUAQg7Im9hEVdeR/4Utu49+fOyxC20NmHppA9UUg2v+FiDfvVquVx1K7mrGFUiVXOXmLalUd', 'content-type': 'application/x-amz-json-1.1', 'content-length': '257', 'date': 'Mon, 26 Aug 2019 01:18:02 GMT'}, 'RetryAttempts': 0}}
</code></pre></div></div>

<p>실제로 Amazon elasticsearch에 샘플데이터가 입력 되었는지 확인한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -XGET https://{es_address}/interest_service_click2/_search\?filter_path\=hits\&amp;format\=json\&amp;pretty
{
  "hits" : {
    "total" : 1,
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "interest_service_click2",
        "_type" : "isc",
        "_id" : "49595937143545169094912243846452981551249391789660962818.0",
        "_score" : 1.0,
        "_source" : {
          "user_id" : "Aster-Kotlin-Sapphire-564",
          "app_version" : "v1.5.16(90)",
          "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
          "device_manufacturer" : "LG",
          "device_name" : "LG G7 ThinQ",
          "device_model" : "LM-G710N",
          "device_os" : "Android",
          "device_os_number" : "8.0",
          "event" : "interest_service_click",
          "interest_id" : 1201,
          "index" : 1,
          "interest_name" : "창업/스타트업",
          "interest_service_id" : null,
          "interest_service_type" : "2",
          "interest_service_name" : "piano",
          "timestamp" : "2019-04-30T07:30:00Z"
        }
      }
    ]
  }
}
</code></pre></div></div>

<p>Amazon elasticsearch의 백업용도로 저장된 S3를 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://test-es-raw-poc/2019/08/26/01/
2019-08-26 10:19:05        520 test-firehose-es-poc-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c

$ aws s3 cp s3://test-es-raw-poc/2019/08/26/01/test-firehose-es-poc-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c ./single_record.txt
download: s3://test-es-raw-poc/2019/08/26/01/test-firehose-es-poc-1-2019-08-26-01-18-03-d2346539-c5c2-4385-b163-4b60b14ea33c to ./single_record.txt

$ cat single_record.txt
{"user_id": "Aster-Kotlin-Sapphire-564", "app_version": "v1.5.16(90)", "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0", "event": "interest_service_click", "interest_id": 1201, "index": 1, "interest_name": "창업/스타트업", "interest_service_id": null, "interest_service_type": "2", "interest_service_name": "piano", "timestamp": "2019-04-30T07:30:00Z"}%
</code></pre></div></div>

<p>테스트 결과는 다음과 같이 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 단일 레코드를 firehose에 전송한다.</p>
  </li>
  <li>
    <p>Amazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 단일 레코드가 정상적으로 전송된 것을 확인할 수 있다.</p>
  </li>
</ul>

<h2 id="케이스--다중-레코드를-firehose에-보내기">케이스 : 다중 레코드를 firehose에 보내기</h2>

<p>다음과 같은 시나리오를 바탕으로 진행한다.</p>

<p>다음과 같은 샘플 데이터를 “test-firehose-es-poc” Delivery stream으로 전송한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ "user_id" : "Aster-Kotlin-Sapphire-564", "app_version" : "v1.5.16(90)", "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer" : "LG", "device_name" : "LG G7 ThinQ", "device_model" : "LM-G710N", "device_os" : "Android", "device_os_number" : "8.0", "event" : "interest_service_click", "interest_id" : 1201, "index" : 1, "interest_name" : "창업/스타트업", "interest_service_id" : null, "interest_service_type" : "2", "interest_service_name" : "piano", "timestamp" : "2019-05-03T01:15:00Z" }
{ "user_id" : "Aster-Kotlin-Sapphire-564", "app_version" : "v1.5.16(90)", "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer" : "LG", "device_name" : "LG G7 ThinQ", "device_model" : "LM-G710N", "device_os" : "Android", "device_os_number" : "8.0", "event" : "interest_service_click", "interest_id" : 1301, "index" : 1, "interest_name" : "취업", "interest_service_id" : null, "interest_service_type" : "배워봐요", "interest_service_name" : "학원",  "timestamp" : "2019-05-03T00:50:00Z" }
{ "user_id" : "Aster-Kotlin-Sapphire-564", "app_version" : "v1.5.16(90)", "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer" : "LG", "device_name" : "LG G7 ThinQ", "device_model" : "LM-G710N", "device_os" : "Android", "device_os_number" : "8.0", "event" : "interest_service_click", "interest_id" : 1101, "index" : 1, "interest_name" : "초등학교", "interest_service_id" : null, "interest_service_type" : "물어봐요", "interest_service_name" : "대나무숲", "timestamp" : "2019-05-03T00:20:00Z" }
</code></pre></div></div>

<p>“test-firehose-es-poc” Deliver stream은 Direct put으로 들어온 데이터를 Amazon elasticsearch에 전송하고 s3에 백업 데이터를 생성한다.</p>

<p>다음과 같은 Python 코드를 작성한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import boto3
import json


def get_firehose_client():
    session = boto3.Session(profile_name="test")
    firehose = session.client("firehose")
    return firehose

def batch_record_to_delivery_stream(test_data_list):
    print("Put multiple records to Deliver Stream")

    records = list(map(lambda data : {"Data": json.dumps(data, ensure_ascii=False)}, test_data_list))

    firehose = get_firehose_client()
    
    response = firehose.put_record_batch(DeliveryStreamName="test-firehose-es-poc",Records=records)
    print(response)

def main():
    test_data_list = [
            {
                "user_id": "Aster-Kotlin-Sapphire-564",
                "app_version": "v1.5.16(90)",
                "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
                "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0",
                "event": "interest_service_click",
                "interest_id": 1101,
                "index": 1,
                "interest_name": "초등학교", "interest_service_id": None, "interest_service_type": "물어봐요","interest_service_name": "대나무숲",
                "timestamp": "2019-05-03T00:20:00Z"
            },
            {
                "user_id": "Aster-Kotlin-Sapphire-564",
                "app_version": "v1.5.16(90)",
                "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
                "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0",
                "event": "interest_service_click",
                "interest_id": 1301,
                "index": 1,
                "interest_name": "취업", "interest_service_id": None, "interest_service_type": "배워봐요","interest_service_name": "학원",
                "timestamp": "2019-05-03T00:50:00Z"
            },
            {
                "user_id": "Aster-Kotlin-Sapphire-564",
                "app_version": "v1.5.16(90)",
                "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
                "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0",
                "event": "interest_service_click",
                "interest_id": 1201,
                "index": 1,
                "interest_name": "창업/스타트업", "interest_service_id": None, "interest_service_type": "2","interest_service_name": "piano",
                "timestamp": "2019-05-03T01:15:00Z"
            },
            {
                "user_id": "Aster-Kotlin-Sapphire-564",
                "app_version": "v1.5.16(90)",
                "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
                "device_manufacturer": "LG",
                "device_name": "LG G7 ThinQ",
                "device_model": "LM-G710N",
                "device_os": "Android",
                "device_os_number": "8.0",
                "event": "interest_service_click",
                "interest_id": 1201,
                "index": 1,
                "interest_name": "창업/스타트업",
                "interest_service_id": None,
                "interest_service_type": "2",
                "interest_service_name": "piano",
                "timestamp": "2019-04-30T07:30:00Z"
            }
        ]
    
	batch_record_to_delivery_stream(test_data_list)

if __name__ == "__main__":
    main()

</code></pre></div></div>

<p>위의 코드를 실행하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3 main.py
Put multiple records to Deliver Stream
{'FailedPutCount': 0, 'Encrypted': False, 'RequestResponses': [{'RecordId': 'JvtN3+H/2oeKA6g087JPipW+g8STzCQQp50mcIw5FQ0wQIC2EihXrB1C31kMjNXY0lcQvXo6bn3H1O/PQMWI3veWxxCb9vkL3lieblJOu+v/q8TLAlsfNCsMADGz9yPLQg4B5uRfogNKv1+M44c6RnAHIg+n5aX/K8UUgbVVF47ZeyiJsokbshNmhO7F8+3BA4rAdXW2O4hSZj640O0RAtw6QuTB3CQN'}, {'RecordId': 'JT+5YNtI/3nwtCiiaoA/w5pBxkHYdbJFwGv8KiYDk7cTjIhenCGmnlBZqpwDswVWNGdnTT+e/qEP3VQI2dx1cwjHDpRRlilNBOYwKZaueoazeQ77p2NKgarweztvVVK1r91PjIlEUlW3fJfSAqiZsCoa6NQDs3u51gRNxi8Z9iBA/3uUXDehUkszxmlIzpvFKmrYrJ6UGIdBDHIpyqmWYdCAwAXJJTBk'}, {'RecordId': 'Mriv4BFuAEpziVO0hX0zZsoCspb8Sl4fdTOUitqYYTKGhfr+7noUWfYTTp0QF0JkuS8z/KHEr8aiV53IrLe860NzZY1mSN4ZAxmIKLxQqwQceFaj0xEBJJuYjrSOuDKRVD3rCz8n/Ab4QzEP/FOrUioKK7uf4kySsE7TvTkW1pWeKHabE27FjK/+9x4//3ep3fjp5K3TO81UX6Xk7AFa5BxiGUjVzcTI'}], 'ResponseMetadata': {'RequestId': 'c59f84d4-d42a-432f-9042-d44926133eb6', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': 'c59f84d4-d42a-432f-9042-d44926133eb6', 'x-amz-id-2': '01OYNLqVZ9T7VGgpQ/pSJ1MtwblA5/kShluUDM6sLzv4ncJEyTrM7lHoKxEwo1EWzbXZmIu7Nz0oaw72UhQhAzAl3Ji9BgqZ', 'content-type': 'application/x-amz-json-1.1', 'content-length': '779', 'date': 'Mon, 26 Aug 2019 03:13:32 GMT'}, 'RetryAttempts': 0}}

</code></pre></div></div>

<p>실제 Amazon elasticsearch에서 레코드가 입력되었는지 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -XGET https://{es_address}/interest_service_click2/_search\?filter_path\=hits\&amp;format\=json\&amp;pretty
{
  "hits" : {
    "total" : 4,
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "interest_service_click2",
        "_type" : "isc",
        "_id" : "49595937143545169094912246787272632161781037484956712962.0",
        "_score" : 1.0,
        "_source" : {
          "user_id" : "Aster-Kotlin-Sapphire-564",
          "app_version" : "v1.5.16(90)",
          "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
          "device_manufacturer" : "LG",
          "device_name" : "LG G7 ThinQ",
          "device_model" : "LM-G710N",
          "device_os" : "Android",
          "device_os_number" : "8.0",
          "event" : "interest_service_click",
          "interest_id" : 1201,
          "index" : 1,
          "interest_name" : "창업/스타트업",
          "interest_service_id" : null,
          "interest_service_type" : "2",
          "interest_service_name" : "piano",
          "timestamp" : "2019-05-03T01:15:00Z"
        }
      },
      {
        "_index" : "interest_service_click2",
        "_type" : "isc",
        "_id" : "49595937143545169094912246787271423235961422855782006786.0",
        "_score" : 1.0,
        "_source" : {
          "user_id" : "Aster-Kotlin-Sapphire-564",
          "app_version" : "v1.5.16(90)",
          "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
          "device_manufacturer" : "LG",
          "device_name" : "LG G7 ThinQ",
          "device_model" : "LM-G710N",
          "device_os" : "Android",
          "device_os_number" : "8.0",
          "event" : "interest_service_click",
          "interest_id" : 1301,
          "index" : 1,
          "interest_name" : "취업",
          "interest_service_id" : null,
          "interest_service_type" : "배워봐요",
          "interest_service_name" : "학원",
          "timestamp" : "2019-05-03T00:50:00Z"
        }
      },
      {
        "_index" : "interest_service_click2",
        "_type" : "isc",
        "_id" : "49595937143545169094912246787270214310141808226607300610.0",
        "_score" : 1.0,
        "_source" : {
          "user_id" : "Aster-Kotlin-Sapphire-564",
          "app_version" : "v1.5.16(90)",
          "device_id" : "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738",
          "device_manufacturer" : "LG",
          "device_name" : "LG G7 ThinQ",
          "device_model" : "LM-G710N",
          "device_os" : "Android",
          "device_os_number" : "8.0",
          "event" : "interest_service_click",
          "interest_id" : 1101,
          "index" : 1,
          "interest_name" : "초등학교",
          "interest_service_id" : null,
          "interest_service_type" : "물어봐요",
          "interest_service_name" : "대나무숲",
          "timestamp" : "2019-05-03T00:20:00Z"
        }
      },
    ]
  }
}
</code></pre></div></div>

<p>백업용 s3 데이터를 확인하면 다음과 같다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws s3 ls s3://test-es-raw-poc/2019/08/26/03/
2019-08-26 12:14:35       1528 test-firehose-es-poc-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f

$ aws s3 cp s3://test-es-raw-poc/2019/08/26/03/test-firehose-es-poc-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f ~/dev/boto3_test/kinesis_data_firehose/multiple_record.txt
download: s3://test-es-raw-poc/2019/08/26/03/test-firehose-es-poc-1-2019-08-26-03-13-33-dd434742-87da-4cbe-b62a-b84c0366215f to dev/boto3_test/kinesis_data_firehose/multiple_record.txt

$ cat dev/boto3_test/kinesis_data_firehose/multiple_record.txt
{"user_id": "Aster-Kotlin-Sapphire-564", "app_version": "v1.5.16(90)", "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0", "event": "interest_service_click", "interest_id": 1101, "index": 1, "interest_name": "초등학교", "interest_service_id": null, "interest_service_type": "물어봐요", "interest_service_name": "대나무숲", "timestamp": "2019-05-03T00:20:00Z"}
{"user_id": "Aster-Kotlin-Sapphire-564", "app_version": "v1.5.16(90)", "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0", "event": "interest_service_click", "interest_id": 1301, "index": 1, "interest_name": "취업", "interest_service_id": null, "interest_service_type": "배워봐요", "interest_service_name": "학원", "timestamp": "2019-05-03T00:50:00Z"}
{"user_id": "Aster-Kotlin-Sapphire-564", "app_version": "v1.5.16(90)", "device_id": "a03cd3d6-0b14-46e1-a2c8-18b1c86cf738", "device_manufacturer": "LG", "device_name": "LG G7 ThinQ", "device_model": "LM-G710N", "device_os": "Android", "device_os_number": "8.0", "event": "interest_service_click", "interest_id": 1201, "index": 1, "interest_name": "창업/스타트업", "interest_service_id": null, "interest_service_type": "2", "interest_service_name": "piano", "timestamp": "2019-05-03T01:15:00Z"}%
</code></pre></div></div>

<p>테스트 결과는 다음과 같이 정리할 수 있다.</p>

<ul>
  <li>
    <p>Boto3를 이용하여 다중 레코드를 firehose에 전송한다.</p>
  </li>
  <li>
    <p>Amazon elasticsearch의 index와 S3의 백업 데이터를 확인한 결과 다중 레코드가 정상적으로 전송된 것을 확인할 수 있다.</p>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#aws-kinesis-firehose" class="page__taxonomy-item" rel="tag">AWS_Kinesis_firehose</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#aws-s3" class="page__taxonomy-item" rel="tag">AWS_S3</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#boto3" class="page__taxonomy-item" rel="tag">Boto3</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#boto3" class="page__taxonomy-item" rel="tag">Boto3</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2019-12-16T00:00:00+09:00">December 16, 2019</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Boto3%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+Amazon+S3%2C+Kinesis+Data+Firehose+%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0%20http%3A%2F%2Flocalhost%3A4000%2Fboto3%2Fboto3_basic%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fboto3%2Fboto3_basic%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fboto3%2Fboto3_basic%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/monitoring/newrelic_basic/" class="pagination--pager" title="New Relic 교육 - 오버뷰
">이전</a>
    
    
      <a href="/docker/docker_basic/" class="pagination--pager" title="Docker 공식 사이트 Chapter 1~3 학습 내용 정리
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/logo.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/kubernetes/kubernetes_basic/" rel="permalink">Kubernetes 입문자를 위한 기초 내용 정리
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">이 문서는 Kuberetes에 대한 기초 내용을 개인적으로 내용을 정리하기 위하여 작성되었다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/logo.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/aws_cli/aws_cli_basic/" rel="permalink">AWS CLI 기초 학습 공유
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">이 문서는 AWS Command Line Interface 사용 설명서를 살펴보며 AWS CLI에 대한 학습했던 내용을 개인적으로 정리하기 위하여 작성되었다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/logo.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/test/jmeter_basic/" rel="permalink">JMeter 기본 사용법
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description"> JMeter는 java로 만들어진 성능 테스트 툴이다. 구매한 솔루션의 Spec을 확인하거나 서버의 스케일링을 위해 사용한다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/assets/images/logo.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/lambda/chalice_tutorial/" rel="permalink">AWS Chalice - Tutorial 기초 학습 정리
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  7 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">이 문서는 AWS Chalice Github README 문서를 학습하며 개인적인 학습정리를 위하여 작성되었다.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 kelpin. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/boto3/boto3_basic/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/boto3/boto3_basic"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://kelpin.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
